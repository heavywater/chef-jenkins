# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.
#
## Path:        Development/Jenkins
## Description: Configuration for the Jenkins continuous build server
## Type:        string
## Default:     <%= node['jenkins']['server']['home'] %> 
## ServiceRestart: jenkins
#

# pulled in from the init script; makes things easier.
NAME=jenkins

# location of java
<% case node['platform'] when 'redhat','centos','scientific','amazon','oracle' -%>
# Java executable to run Jenkins
JENKINS_JAVA_CMD="<%= node['jenkins']['java_home'] %>/bin/java"
<% else -%>
JAVA="<%= node['jenkins']['java_home'] %>/bin/java"
<% end -%>

# arguments to pass to java
<% case node['platform'] when 'redhat','centos','scientific','amazon','oracle' -%>
JENKINS_JAVA_OPTIONS="<%= node['jenkins']['java_options'] %>"
<% else -%>
#JAVA_ARGS="-Xmx256m"
#JAVA_ARGS="-Djava.net.preferIPv4Stack=true" # make jenkins listen on IPv4 address
JAVA_ARGS="<%= node['jenkins']['java_options'] %>"
<% end -%>

<% case node['platform'] when 'redhat','centos','scientific','amazon','oracle' -%>
JENKINS_PID_FILE="<%= node['jenkins']['pid_file'] %>"
<% else -%>
PIDFILE=<%= node['jenkins']['pid_file'] %>
<% end -%>

# user id to be invoked as (otherwise will run as root; not wise!)
JENKINS_USER=<%= node['jenkins']['server']['user'] %>

# location of the jenkins war file
JENKINS_WAR=<%= node['jenkins']['war_file'] %>

# jenkins home location
JENKINS_HOME=<%= node['jenkins']['server']['home'] %>

<%# Some redhat default-isms -%>
<% case node['platform'] when 'redhat','centos','scientific','amazon','oracle' -%>
# Debug level for logs -- the higher the value, the more verbose.
# 5 is INFO
JENKINS_DEBUG_LEVEL="5"

# Whether to enable access logging or not.
JENKINS_ENABLE_ACCESS_LOG="no"

# Maximum number of HTTP worker threads.
JENKINS_HANDLER_MAX="100"

# Maximum n umber of idle HTTP worker threads.
JENKINS_HANDLER_IDLE="20"
<%# Some debian default-isms -%>
<% else -%>
# set this to false if you don't want Hudson to run by itself
# in this set up, you are expected to provide a servlet container
# to host jenkins.
RUN_STANDALONE=true

# log location.  this may be a syslog facility.priority
JENKINS_LOG=/var/log/jenkins/$NAME.log
#HUDSON_LOG=daemon.info

# OS LIMITS SETUP
#   comment this out to observe /etc/security/limits.conf
#   this is on by default because http://github.com/jenkinsci/jenkins/commit/2fb288474e980d0e7ff9c4a3b768874835a3e92e
#   reported that Ubuntu's PAM configuration doesn't include pam_limits.so, and as a result the # of file
#   descriptors are forced to 1024 regardless of /etc/security/limits.conf
MAXOPENFILES=8192
<% end -%>

# port for HTTP connector (default 8080; disable with -1)
<% case node['platform'] when 'redhat','centos','scientific','amazon','oracle' -%>
JENKINS_PORT=<%= node['jenkins']['server']['port'] -%>
<% else -%>
HTTP_HOST=<%= node['jenkins']['server']['host'] %>
HTTP_PORT=<%= node['jenkins']['server']['port'] %>
<% end -%>

# port for AJP connector (disabled by default)
<% case node['platform'] when 'redhat','centos','scientific','amazon','oracle' -%>
JENKINS_AJP_PORT=<%= node['jenkins']['ajp_port'] %>
<% else -%>
AJP_PORT=<%= node['jenkins']['ajp_port'] %>
<% end -%>

<% case node['platform'] when 'debian','ubuntu' -%> 
# arguments to pass to jenkins.
# --javahome=$JAVA_HOME
# --httpPort=$HTTP_PORT (default 8080; disable with -1)
# --httpsPort=$HTTP_PORT
# --ajp13Port=$AJP_PORT
# --argumentsRealm.passwd.$ADMIN_USER=[password]
# --argumentsRealm.$ADMIN_USER=admin
# --webroot=~/.jenkins/war
JENKINS_ARGS="--webroot=/var/run/jenkins/war --httpListenAddress=$HTTP_HOST --httpPort=$HTTP_PORT --ajp13Port=$AJP_PORT"
<% else -%>
JENKINS_ARGS=""
<% end -%>
